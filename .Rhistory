#install.packages("R2WinBUGS")
library("R2WinBUGS")
data(schools)
schools
mod1 <- function(){
for (j in 1:J)
{
y[j] ~ dnorm (theta[j], tau.y[j])
theta[j] ~ dnorm (mu.theta, tau.theta)
tau.y[j] <- pow(sigma.y[j], -2)
}
mu.theta ~ dnorm (0.0, 1.0E-6)
tau.theta <- pow(sigma.theta, -2)
sigma.theta ~ dunif (0, 1000)
}
J <- nrow(schools)
y <- schools$estimate
sigma.y <- schools$sd
data <- list("J", "y", "sigma.y")
inits <- function(){
list(theta = rnorm(J, 0, 100),
mu.theta = rnorm(1, 0, 100),
sigma.theta = runif(1, 0, 100))
}
schools.sim <-  bugs(data = data,
inits = inits,
model.file = mod1,
parameters.to.save
= c("theta", "mu.theta", "sigma.theta"),
n.chains = 4,
n.iter = 2000,
bugs.directory = "c:/Program Files/WinBUGS14/")
# summary statistics
print(schools.sim)
plot(schools.sim)
# time series plot
plot(schools.sim, display.parallel = TRUE)
plot(schools.sim$sims.list$theta[,1]~c(1:schools.sim$n.sims),
type = "l",
col = "red",
xlab = "t",
ylab = expression(theta[1]))
plot(density(schools.sim$sims.list$theta[,1]))
# More inference
# Bayes type-I error for testing H0: theta_1<10
mean(schools.sim$sims.list$theta[,1]>10)
# Compare the treatment effect
mean(schools.sim$sims.list$theta[,1])>mean(schools.sim$sims.list$theta[,3])
gc()
